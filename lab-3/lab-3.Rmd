---
title: "Lab 3: Classification"
author: "PSTAT 131/231"
output:
    html_document:
      toc: true
      toc_float: true
      code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
                      warning = FALSE)
```

## Introduction

This lab will be our first experience with classification models. These models differ from the regression model we saw in the last chapter by the fact that the response variable is a qualitative variable instead of a continuous variable. This chapter will use ['parsnip'](https://www.tidymodels.org/start/models/) for model fitting and ['recipes and workflows'](https://www.tidymodels.org/start/recipes/) to perform the transformations.

### Loading Packages

We load `tidymodels` for modeling functions, `ISLR` and `ISLR2` for data sets, `discrim` to give us access to discriminant analysis models such as LDA and QDA, as well as the Naive Bayes model, and `poissonreg` for Poisson regression. Finally, we load `corrr` for aid in visualizing correlation matrices.

```{r}
library(tidymodels)
library(ISLR) # For the Smarket data set
library(ISLR2) # For the Bikeshare data set
library(discrim)
library(poissonreg)
library(corrr)
```

### Data

We will be examining the `Smarket` data set for this lab. It contains a number of numeric variables, plus a variable called `Direction` which has two labels, "Up" and "Down". Before we go on to modeling, we'll explore the data a little, at least to look at possible correlations between the variables.

#### Activities

- Access the help page for `Smarket`. What does the `Direction` variable represent? What predictors do you think might be correlated with it?

To look at correlations among the continuous variables, we will use the `corrr` package. The `correlate()` function will calculate the correlation matrix between all the variables that it is given. We choose to remove `Direction,` as it is not numeric. Then we pass the results to rplot() to visualize the correlation matrix.

```{r}
cor_Smarket <- Smarket %>%
  select(-Direction) %>%
  correlate()
rplot(cor_Smarket, colours = c("indianred2", "black", "skyblue1"))
```


## Resources

The free book [Tidy Modeling with R](https://www.tmwr.org/) is strongly recommended.

## Source

Several parts of this lab come directly from the ["ISLR Tidymodels Labs"](https://emilhvitfeldt.github.io/ISLR-tidymodels-labs/classification.html). Credit to Emil Hvitfeldt for writing and maintaining the open-source book.